# ECサイト構築タスク

---

## バックエンドの構築手順

### 1. 環境構築

- [ ] **プロジェクト作成**: 新しいディレクトリを作成し、`npm init -y` でプロジェクトを初期化。必要なパッケージ（`express`, `jsonwebtoken`, `mongoose`, `bcrypt`, `body-parser`, `cors`など）をインストール。
- [ ] **MongoDB の設定**: MongoDB Atlas のアカウントを作成し、新しいデータベースを作成。ローカル環境で実行する場合は、MongoDB をインストールし、`mongod` コマンドでサーバーを起動。

### 2. サーバーとルーティングの設定

- [ ] **Express サーバーの設定**: `server.js` ファイルを作成し、`express` と `body-parser` でリクエストを処理できるように設定。`cors` を設定し、フロントエンドと通信できるようにする。
- [ ] **API ルーティングの基本構造**: `routes` フォルダを作成し、`users.js`, `products.js`, `cart.js`, `orders.js` のルーティングファイルを作成。`server.js` でルーティングをインポートして、APIエンドポイントをルーティングに接続。

### 3. モデルの作成

- [ ] **ユーザーモデル**: `models/User.js` を作成し、`username`, `email`, `password`, `createdAt` などのフィールドを含むスキーマを定義。`bcrypt` を使用して、パスワードをハッシュ化するメソッドを設定。
- [ ] **商品モデル**: `models/Product.js` を作成し、`name`, `description`, `price`, `image`, `stock` などのフィールドを含むスキーマを定義。
- [ ] **カートモデル**: `models/Cart.js` を作成し、`userId`, `items`（商品の ID と数量）を含むスキーマを定義。
- [ ] **注文モデル**: `models/Order.js` を作成し、`userId`, `items`, `totalPrice`, `status`, `createdAt` を含むスキーマを定義。

### 4. ユーザー認証機能の実装

- [ ] **ユーザー登録**: `routes/users.js` で新しいユーザーを登録するエンドポイント `/register` を作成。パスワードをハッシュ化して、データベースに保存。
- [ ] **ログイン**: `/login` エンドポイントを作成し、ユーザーが提供したパスワードとデータベースのパスワードを比較。JWT（JSON Web Token）を生成し、成功時にトークンを返す。
- [ ] **認証ミドルウェア**: 認証が必要なエンドポイント（カートや注文関連）に適用するため、JWT を検証するミドルウェア `authMiddleware.js` を作成。

### 5. 商品管理機能の実装

- [ ] **商品一覧と詳細取得**: `routes/products.js` で `/products` エンドポイントを作成し、商品一覧を取得。`/products/:id` で特定商品の詳細を取得。
- [ ] **商品追加・編集・削除（管理者用）**: 商品の追加、編集、削除を行うエンドポイントを作成（適切な認証・認可を追加）。

### 6. カート機能の実装

- [ ] **カートへの商品追加**: `routes/cart.js` に `/cart` エンドポイントを作成し、カートに商品を追加する処理を実装。
- [ ] **カート内容の取得・削除**: カート内の商品一覧を取得し、ユーザーが商品の数量を更新したり削除できるようにする。

### 7. 注文処理の実装

- [ ] **注文の作成**: `routes/orders.js` で `/orders` エンドポイントを作成し、カート内容を元に注文を作成。合計金額を計算し、注文情報をデータベースに保存。
- [ ] **注文履歴とステータス確認**: 注文履歴と進行状況を取得するためのエンドポイントを作成。

---

## フロントエンドの構築手順

### 1. プロジェクトとファイルの準備

- [ ] **ディレクトリ構成の設定**: `public` フォルダに HTML ファイルと CSS ファイルを配置。`js` フォルダに JavaScript ファイル（`login.js`, `products.js`, `cart.js`など）を作成。
- [ ] **基本レイアウトの作成**: `index.html`（商品一覧）、`product.html`（商品詳細）、`login.html`（ユーザー認証）、`cart.html`（カート）、`orders.html`（注文履歴）を作成し、それぞれのページに必要な要素（ボタン、フォームなど）を配置。

### 2. ユーザー認証ページ

- [ ] **ユーザー登録とログインフォーム**: `login.html` にユーザー名とパスワードの入力フォームを配置し、サインアップとログインのボタンを設置。`login.js` を作成し、サーバーの `/register` と `/login` API にリクエストを送信。
- [ ] **JWT トークンの管理**: ログイン時に取得したトークンを `localStorage` に保存し、各ページのリクエスト時にトークンをヘッダーに付与。

### 3. 商品一覧ページ

- [ ] **商品一覧の表示**: `products.js` で `/products` API から商品データを取得し、`index.html` で名前や価格を表示。各商品にリンクを追加し、クリックで詳細ページ（`product.html`）に遷移。

### 4. 商品詳細ページ

- [ ] **商品情報の取得**: `product.js` で `/products/:id` エンドポイントから特定の商品の情報を取得し、`product.html` に詳細情報を表示。
- [ ] **カートに追加ボタン**: `product.js` にカート追加機能を実装し、選択した商品をカートに追加するリクエストを送信。

### 5. カートページ

- [ ] **カート内容の取得**: `cart.js` で `/cart` エンドポイントからカート内容を取得し、`cart.html` に一覧表示。各商品の数量を変更・削除できるようにする。
- [ ] **注文確定ボタン**: カート内の商品を基に注文を作成するため、注文リクエストを送信するボタンを設置。

### 6. 注文履歴ページ

- [ ] **注文履歴の取得**: `orders.js` で `/orders` エンドポイントから注文履歴を取得し、`orders.html` に一覧表示。各注文のステータスを表示できるようにする。

---

## テストとデプロイ

- [ ] **PostmanでAPIテスト**: 各エンドポイントが正しく動作するか確認するために、Postmanを使用してバックエンドAPIをテスト。
- [ ] **統合テスト**: フロントエンドとバックエンドの統合テストを行い、ユーザー登録・ログイン、商品閲覧、カート追加、注文処理の一連の動作を確認。
- [ ] **デプロイ**: バックエンドをHeroku、フロントエンドをNetlifyやGitHub Pagesなどにデプロイし、公開。


# ECサイトバックエンド要件定義

## システム概要
ユーザーが商品を閲覧し、カートに追加して注文できるシンプルなECサイトのバックエンドAPIを構築します。このAPIは、ユーザー登録や認証、商品管理、カート、注文管理の機能を提供します。

## 必須機能

### 1. ユーザー管理
- **ユーザー登録**：新規ユーザーを登録できる。
- **ログイン・ログアウト**：JWTを利用して認証トークンを発行し、ログイン状態を管理。
- **ユーザーデータの取得・更新**：登録したユーザー情報を取得・更新可能。

### 2. 商品管理
- **商品一覧の取得**：すべての商品を取得し、クライアント側で一覧表示可能。
- **商品詳細の取得**：特定の商品情報を詳細に取得。
- **商品追加・更新・削除**：管理者のみ商品情報のCRUD操作が可能。

### 3. カート機能
- **カートへの商品追加・削除**：ユーザーが商品をカートに追加・削除。
- **カート内の商品一覧取得**：ユーザーごとにカート内容を取得し、表示可能。

### 4. 注文処理
- **注文の作成**：カート内の商品情報を元に注文を作成。
- **注文ステータス管理**：注文の進行状況を管理できる（例：受注、発送中、完了など）。

## 使用技術

### 開発環境
- **Node.js + Express**：サーバーサイドのフレームワーク。
- **MongoDB**：データベース（MongoDB Atlasやローカル環境）。
- **JWT**：ユーザー認証用のトークン発行。
- **Postman**：APIのテストツールとして利用（フロントエンドがない場合の動作確認用）。

# フロントエンドページ構成（ECサイトデモ用）

このECサイトバックエンドのデモを行うために必要なフロントエンドページは、最低限以下の5ページで構成できます。これで主要なバックエンド機能の操作が確認できるようになります。

---

## 1. ユーザー認証ページ（ログイン/登録ページ）

- **目的**: 新規ユーザーの登録およびログインを提供する。
- **要件**: 
  - 登録用フォーム（ユーザー名、パスワード入力）。
  - ログイン用フォーム（ユーザー名、パスワード入力）。
  - ログイン成功後にJWTトークンを保存し、各ページでの認証状態を管理。
- **ルーティング例**: `/login`、`/register`

## 2. 商品一覧ページ

- **目的**: ECサイトのすべての商品を表示する。
- **要件**: 
  - APIから商品一覧を取得し、名前・価格・サムネイルを表示。
  - 各商品をクリックすると詳細ページへ遷移。
- **ルーティング例**: `/products`

## 3. 商品詳細ページ

- **目的**: 特定の商品の詳細情報を表示し、カートに追加する機能を提供。
- **要件**: 
  - 商品の詳細情報（名前、説明、価格など）をAPIから取得し表示。
  - 「カートに追加」ボタンを設置し、追加処理を実行。
- **ルーティング例**: `/products/:productId`

## 4. カートページ

- **目的**: カートに追加した商品の一覧を確認し、数量の変更や削除ができる。
- **要件**: 
  - カート内商品のリストをAPIから取得し、一覧表示。
  - 各商品の数量変更、削除機能。
  - 「注文を確定」ボタンを設置して、注文処理を実行。
- **ルーティング例**: `/cart`

## 5. 注文履歴ページ

- **目的**: ユーザーが行った注文の一覧や詳細を確認できる。
- **要件**: 
  - ユーザーの注文履歴をAPIから取得し、一覧表示。
  - 各注文のステータス（例：受注、発送済み）を確認可能。
- **ルーティング例**: `/orders`

---

## 各ページの役割とAPI連携

1. **ユーザー認証ページ**: `/api/users/register` と `/api/users/login` エンドポイントと連携。
2. **商品一覧ページ**: `/api/products` エンドポイントを使用して商品一覧を取得。
3. **商品詳細ページ**: `/api/products/:id` エンドポイントで商品の詳細を取得し、`/api/cart` でカートに追加。
4. **カートページ**: `/api/cart` でカート内容を取得・更新・削除、`/api/orders` で注文処理を実行。
5. **注文履歴ページ**: `/api/orders` で注文履歴を取得し、ステータス確認。

---

この5ページで、基本的なECサイトのバックエンド機能を確認・テストするために必要な最低限のフロントエンドを構成できます。
**